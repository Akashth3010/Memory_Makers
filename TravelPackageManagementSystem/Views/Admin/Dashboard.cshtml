@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="admin-page dashboard-page">

    <h2 class="page-heading">Admin Dashboard</h2>
    <p class="page-subtext">
        Overview of your travel platform performance ✨
    </p>

    <div class="stats-grid">

        <div class="stat-card glow-card" data-count="24">
            <div class="stat-icon bg-blue">
                <i class="fa-solid fa-box-archive"></i>
            </div>
            <div class="stat-info">
                <h3 class="stat-number">0</h3>
                <p>Total Packages</p>
            </div>
        </div>

        <div class="stat-card glow-card" data-count="6">
            <div class="stat-icon bg-orange">
                <i class="fa-solid fa-clock"></i>
            </div>
            <div class="stat-info">
                <h3 class="stat-number">0</h3>
                <p>Pending Approvals</p>
            </div>
        </div>

        <div class="stat-card glow-card" data-count="128">
            <div class="stat-icon bg-green">
                <i class="fa-solid fa-calendar-check"></i>
            </div>
            <div class="stat-info">
                <h3 class="stat-number">0</h3>
                <p>Total Bookings</p>
            </div>
        </div>

        @* FIXED: Registered Users Card *@
        <div class="stat-card glow-card" data-count="@(ViewBag.TotalAccounts ?? 0)">
            <div class="stat-icon bg-purple">
                <i class="fa-solid fa-users"></i>
            </div>
            <div class="stat-info">
                <h3 class="stat-number">0</h3>
                <p>Registered Users</p>
            </div>
        </div>

        @* FIXED: Users Online Card *@
        <div class="stat-card glow-card" data-count="@(ViewBag.OnlineUsers ?? 0)">
            <div class="stat-icon bg-green">
                <i class="fa-solid fa-signal"></i>
            </div>
            <div class="stat-info">
                <h3 class="stat-number">0</h3>
                <p>Users Online</p>
            </div>
        </div>

    </div>

    <div class="dashboard-message">
        <h4>Welcome back, Admin 👋</h4>
        <p>
            Currently, there are <b>@(ViewBag.OnlineUsers ?? 0)</b> users active on the platform.
            Let’s keep the platform updated and engaging!
        </p>
    </div>

</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    $(document).ready(function () {
        // Animation for numbers
        $('.stat-card').each(function () {
            let card = $(this);
            let target = parseInt(card.attr('data-count')) || 0; // Ensure it's a number
            let numberEl = card.find('.stat-number');

            $({ count: 0 }).animate(
                { count: target },
                {
                    duration: 1200,
                    easing: 'swing',
                    step: function () {
                        numberEl.text(Math.floor(this.count));
                    },
                    complete: function () {
                        numberEl.text(target);
                    }
                }
            );
        });

        // Hover glow pulse logic
        $('.stat-card').hover(
            function () {
                $(this).addClass('active-glow');
            },
            function () {
                $(this).removeClass('active-glow');
            }
        );
    });
</script>