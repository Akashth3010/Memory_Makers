@model IEnumerable<TravelPackageManagementSystem.Repository.Models.TravelPackage>

@{
    ViewData["Title"] = $"Explore {ViewBag.StateName}";
}

<style>
    /* Professional Card Styling */
    .destination-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: none;
        border-radius: 20px;
        overflow: hidden;
        background: #fff;
    }

        .destination-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

    /* Infinite Scrolling Gallery Logic */
    .auto-scroll-container {
        overflow: hidden;
        padding: 40px 0;
        background: #f8f9fa;
        border-radius: 20px;
        position: relative;
        width: 100%;
    }

    .scroll-track {
        display: flex;
        width: max-content; /* Vital: Keeps all items in one long line */
        animation: scroll 30s linear infinite; /* Increased time for smoother movement */
    }

        /* Pause on hover so users can enjoy the gems */
        .scroll-track:hover {
            animation-play-state: paused;
        }

    .gem-item {
        flex: 0 0 280px; /* Fixed width for each gem */
        padding: 0 15px;
        text-align: center;
    }

        .gem-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .gem-item:hover img {
            transform: scale(1.05);
        }

    /* The Secret to the Infinite Loop */
    @@keyframes scroll {
        0% {
            transform: translateX(0);
        }

        100% {
            /* Since we have 2 sets of images, moving -50% loops perfectly */
            transform: translateX(-50%);
        }
    }
</style>

<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold">Explore <span class="text-success">@ViewBag.StateName</span></h1>
        <p class="text-muted">Discover the best-selling packages for @ViewBag.StateName</p>
    </div>

    @* Package Cards Section *@
    <div class="row g-4 mb-5">
        @foreach (var package in Model)
        {
            <div class="col-md-4">
                <div class="card h-100 destination-card shadow-sm">
                    <img src="@package.ImageUrl" class="card-img-top" style="height: 250px; object-fit: cover;">
                    <div class="card-body text-center">
                        <h5 class="fw-bold">@package.PackageName</h5>
                        <p class="small text-muted">@package.Duration • @package.Location</p>
                        <h4 class="text-primary fw-bold">₹@package.Price.ToString("N0")</h4>

                        <a asp-controller="Home" asp-action="MeghPack3" asp-route-id="@package.PackageId" class="btn btn-danger rounded-pill px-4 mt-2">View Details</a>
                    </div>
                </div>
            </div>
        }
    </div>

    @* Dynamic Hidden Gems Gallery *@
    <div class="mt-5">
        <h2 class="text-center fw-bold mb-4">Hidden <span class="text-success">Gems</span> of @ViewBag.StateName</h2>

        <div class="auto-scroll-container">
            <div class="scroll-track">
                @if (Model.Any() && Model.First().ParentDestination?.GalleryImages != null)
                {
                    var gems = Model.First().ParentDestination.GalleryImages.ToList();

                    @* LOOP 1: Original Set *@
                    foreach (var gem in gems)
                    {
                        <div class="gem-item">
                            <img src="@gem.ImageUrl" alt="@gem.Caption">
                            <span class="d-block mt-2 fw-semibold text-dark">@gem.Caption</span>
                        </div>
                    }

                    @* LOOP 2: Identical Clone Set (Removes the blank space) *@
                    foreach (var gem in gems)
                    {
                        <div class="gem-item">
                            <img src="@gem.ImageUrl" alt="@gem.Caption">
                            <span class="d-block mt-2 fw-semibold text-dark">@gem.Caption</span>
                        </div>
                    }
                }
                else
                {
                    <div class="text-center w-100 py-4">
                        <p class="text-muted">No hidden gems available for this destination.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>